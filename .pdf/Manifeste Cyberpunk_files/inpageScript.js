(()=>{"use strict";class e{constructor(){this.enabled=!1,this.isEnabled=!1,this.executing=!1}enable(){return this.enabled?Promise.resolve({enabled:!0}):this.execute("enable").then((e=>("boolean"==typeof e.enabled&&(this.enabled=e.enabled,this.isEnabled=e.enabled),e)))}getInfo(){if(!this.enabled)throw new Error("Provider must be enabled before calling getInfo");return this.execute("getInfo")}getTransactions(){if(!this.enabled)throw new Error("Provider must be enabled before calling getTransactions");return this.execute("getTransactions")}lnurl(e){if(!this.enabled)throw new Error("Provider must be enabled before calling lnurl");return this.execute("lnurl",{lnurlEncoded:e})}sendPayment(e){if(!this.enabled)throw new Error("Provider must be enabled before calling sendPayment");return this.execute("sendPaymentOrPrompt",{paymentRequest:e})}keysend(e){if(!this.enabled)throw new Error("Provider must be enabled before calling keysend");return this.execute("keysendOrPrompt",e)}makeInvoice(e){if(!this.enabled)throw new Error("Provider must be enabled before calling makeInvoice");return"object"!=typeof e&&(e={amount:e}),this.execute("makeInvoice",e)}signMessage(e){if(!this.enabled)throw new Error("Provider must be enabled before calling signMessage");return this.execute("signMessageOrPrompt",{message:e})}verifyMessage(e,t){if(!this.enabled)throw new Error("Provider must be enabled before calling verifyMessage");return this.execute("verifyMessage",{signature:e,message:t})}execute(e,t){return new Promise(((r,n)=>{window.postMessage({application:"LBE",prompt:!0,type:`${e}`,args:t},"*"),window.addEventListener("message",(function e(t){t.data&&t.data.response&&"LBE"===t.data.application&&(t.data.data.error?n(new Error(t.data.data.error)):r(t.data.data.data),window.removeEventListener("message",e))}))}))}}document?(window.webln=new e,window.addEventListener("click",(e=>{const t=e.target;if(!t||!t.closest)return;const r=t.closest('[href^="lightning:" i]'),n=t.closest('[href^="lnurl" i]'),s=t.closest('[href*="lightning=ln" i]');let a,i,o;if(r||s||n){if(e.preventDefault(),r)a=r.getAttribute("href").toLowerCase(),i=a.replace("lightning:","");else if(s){a=s.getAttribute("href");const e=new URL(a),t=new URLSearchParams(e.search);i=t.get("lightning")}else n&&(a=n.getAttribute("href").toLowerCase(),o=a.replace(/^lnurl[pwc]:/i,""));(i||o)&&(i&&i.startsWith("lnurl")&&(o=i.replace(/^lnurl[pwc]:/i,"")),i&&i.match(/(\S+@\S+)/)&&(o=i.match(/(\S+@\S+)/)[1]),window.webln.enable().then((e=>{if(e.enabled)return o?window.webln.lnurl(o).then((e=>{console.log(e)})).catch((e=>{console.log(e),alert(`Error: ${e.message}`)})):window.webln.sendPayment(i).then((e=>{console.log(e)})).catch((e=>{console.log(e),alert(`Error: ${e.message}`)}))})))}}))):console.warn("Failed to inject WebLN provider")})();